<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æŒªè½¦å°åŠ©æ‰‹</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
        font-family: Arial, sans-serif; 
        display: flex; 
        align-items: center;
        justify-content: center;
        height: 100vh; 
        background: #f8f9fa; 
        color: #333; }
        .container {
        text-align: center; 
        padding: 20px; 
        width: 100%; 
        max-width: 400px; 
        border-radius: 8px; 
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); 
        background: #fff;;
        }
        button {
            margin: 40px 0;
            font-weight: bold;
            color: #fff;
        }
       .car-icon { font-size: 42px; margin-bottom: 20px; color: #8e44ad; }
        input[type="text"] {
            width: 100%;
            padding: 12px;
            font-size: 15px;
            border-radius: 8px;
            margin-bottom: -15px;
            border: 1px solid #d0d7de;
        }
        .btna {
            flex: 1;
            padding: 12px 130px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
      
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 18px;
            font-size:32px;
        }
        h3 {
            text-align: center;
            margin-bottom: 18px;
            font-size:14px;
        }
      textarea {
            width: 100%;
            height: 120px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 8px;
            resize: none;
            font-size: 16px;
            margin-bottom: -25px;
            background: #f9f9f9;
        }
   .char-count {
            text-align: right;
            color: #666;
            font-size: 12px;
            margin-bottom: 50px;
             margin-right: 5px;
        }
    .message-area {
            margin-bottom: -60px;
        }
        .templates {
            display: flex;
            flex-direction: column;
            margin-bottom: 20px;
        }
        .templates select {
            padding: 10px;
            font-size: 14px;
            border-radius: 6px;
            border: 1px solid #ccc;
        }
        .action-buttons {
            display: flex;
            gap: 10px;
            width: 95%;
            margin: 0px auto;
        }
         .btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        .notify-btn {
            background: linear-gradient(45deg, #00b09b, #96c93d);
            font-size: 18px;
          margin-bottom: 10px;
	    color: white;
        }
        .notify-btn:hover { 
	    box-shadow: 0 6px 20px rgba(0, 176, 155, 0.3);
            transform: translateY(-2px); }
        .call-btn {  
	    background: linear-gradient(45deg, #5370e6, #8558e9);
                     font-size: 22px;
          margin-bottom: 10px;
            color: white;
	    display: none; } /* é»˜è®¤éšè—æ‹¨æ‰“ç”µè¯æŒ‰é’® */
        .call-btn:hover {
	     box-shadow: 0 6px 20px rgba(71, 118, 230, 0.3);
            transform: translateY(-2px);}            
        .notification-count {
            text-align: center;
            margin-bottom: 5px;
            font-size: 18px;
            color: #007bff;
        }
        .notification-counta {
            text-align: center;
            font-size: 9px;
            color: #007bff;
        }     
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.5); z-index: 1000; }
        .modal-content { position: relative; background-color: white; margin: 20% auto; padding: 20px; width: 90%; max-width: 400px; border-radius: 10px; text-align: center; }
        .modal-title { margin-bottom: 15px; font-size: 18px; color: #2c3e50; }
        .modal-phone { font-size: 24px; color: #007bff; margin-bottom: 20px; }
        .modal-buttons { display: flex; gap: 10px; justify-content: center; }
        .modal-btn { padding: 8px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; transition: all 0.3s ease; }
        .confirm-btn { background: #28a745; color: white; }
        .confirm-btn:hover { background: #218838; }
        .cancel-btn { background: #dc3545; color: white; }
        .cancel-btn:hover { background: #c82333; }
.btn.disabled {
    position: relative; /* Ensure the button is positioned relative for the overlay */
    pointer-events: none; /* Disable clicking */
}

/* Create the overlay using the ::before pseudo-element */
.btn.disabled::before {
    content: ''; /* Required to create the pseudo-element */
    position: absolute; /* Position the overlay over the button */
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5); /* 80% transparent gray */
    pointer-events: none; /* Prevent the overlay from blocking interactions */
    border-radius: inherit; /* Inherit the border radius of the button */
}
    </style>
</head>
<body>
 <div class="container" id="inputContainer">
        <div class="car-icon">&#128663;</div>
        <h1>è¯·è¾“å…¥è½¦ç‰Œå·</h1>
        <input type="text" id="licensePlateInput" placeholder="å¦‚ï¼šäº¬A88888">
        <button class="btna notify-btn" onclick="checkLicensePlate()">ç¡®è®¤è½¦ç‰Œå·</button>
        <p id="errorMessage" style="color: red; display: none;">æœªæ‰¾åˆ°è¯¥è½¦ç‰Œå·ï¼Œè¯·æ£€æŸ¥å¹¶é‡æ–°è¾“å…¥ã€‚</p>
    </div>
 
 <div class="container" id="notificationContainer" style="display:none;">
    <h1>ä¸´æ—¶åœè½¦ ğŸ…¿ è¯·å¤šå…³ç…§</h1>
	<h3 align="center">æ‚¨å¯ä»¥é€‰æ‹©é¢„è®¾æ¨¡æ¿æˆ–è‡ªè¡Œè¾“å…¥å†…å®¹</h3>
<div class="templates">
    <select id="templateSelect" onchange="useTemplateFromSelect()">
        <option value="" disabled selected>ç‚¹æˆ‘é€‰æ‹©é€šçŸ¥æ¨¡æ¿</option>
        <option value="æ‚¨å¥½ï¼Œæœ‰äººéœ€è¦æ‚¨æŒªè½¦ï¼Œè¯·åŠæ—¶èµ¶æ¥ã€‚">é»˜è®¤æ¨¡æ¿</option>
        <option value="æ‚¨å¥½ï¼Œæ‚¨çš„è½¦è¾†é˜»ç¢ä»–äººé€šè¡Œï¼Œè¯·å°½å¿«æŒªè½¦ï¼Œè°¢è°¢é…åˆã€‚">ç¤¼è²Œæ¨¡æ¿</option>
        <option value="æƒ…å†µç´§æ€¥ï¼æƒ…å†µç´§æ€¥ï¼è¯·ç«é€Ÿèµ¶æ¥æŒªè½¦ï¼">ç´§æ€¥æ¨¡æ¿</option>
        <option value="æ‚¨çš„è½¦è¾†åœæ”¾æ—¶æœªå®Œå…¨å…³é—­è½¦çª—ã€‚ä¸ºé¿å…é›¨æ°´è¿›å…¥è½¦å†…æˆ–ä¸¢å¤±ç‰©å“ï¼Œè¯·å°½å¿«æ£€æŸ¥å¹¶å…³é—­è½¦çª—ï¼">å…³çª—æé†’</option>
    </select>
</div>
    <div class="message-area" >
        <textarea id="messageInput" maxlength="50" placeholder="è¯·ç‚¹æˆ‘è¾“å…¥é€šçŸ¥å†…å®¹" oninput="updateCharCount()"></textarea>
        <div id="charCount" class="char-count">0/50å­—</div>
    </div>
    <div class="action-buttons">
        <button id="notifyBtn" class="btn notify-btn" onclick="notifyOwner() ">å¾®ä¿¡ä¸€é”®é€šçŸ¥è½¦ä¸»ğŸ“±</button>
        <button id="callBtn" class="btn call-btn" onclick="showCallModal()">ä¸€é”®æ‹¨æ‰“è½¦ä¸»ç”µè¯ğŸ“</button> <!-- é»˜è®¤éšè—æ‹¨æ‰“ç”µè¯æŒ‰é’® -->
    </div>
    <div class="notification-count" id="notificationCountDisplay">å·²å‘é€å¾®ä¿¡é€šçŸ¥æ¬¡æ•°ï¼š0/5</div> <!-- æ˜¾ç¤ºå‘é€æ¬¡æ•° -->
   <div class="notification-counta" id="timeUntilReset">å¾®ä¿¡é€šçŸ¥é‡ç½®å‰©ä½™æ—¶é—´ï¼š  åˆ†é’Ÿ  ç§’</div>
</div>
<!-- æ¨¡æ€æ¡† -->
<div id="callModal" class="modal">
    <div class="modal-content">
        <div class="modal-title">è½¦ä¸»ç”µè¯å·ç </div>
        <div id="phoneNumber" class="modal-phone"></div> <!-- ç”µè¯å·ç å°†åŠ¨æ€è®¾ç½® -->
        <div class="modal-buttons">
            <button class="modal-btn confirm-btn" onclick="callOwner()">å‘¼å«</button>
            <button class="modal-btn cancel-btn" onclick="closeModal()">å–æ¶ˆ</button>
        </div>
    </div>
</div>
<script>
  // é…ç½®è½¦ä¸»ä¿¡æ¯å’Œ Wxpusher API

// è½¦ä¸»çš„UIDæ•°ç»„
        const wxpusherUIDs = {
            "äº¬A66666": ['UID_10gq26e5DEdsMIjlHFuPNW3dAmD9'],
            "æ²ªA88888": ['UID_10gq26e5DEdsMIjlHFuPNW3dAmD9']
        };    //è½¦ç‰Œå·å¡«å†™ä½ç½®
        const phoneNumbers = {
            "äº¬A66666": "18888888888",
            "æ²ªA88888": "16666666666"
        };            //è½¦ç‰Œå·å¯¹åº”æ‰‹æœºå·å¡«å†™ä½ç½®
  const wxpusherAppToken = 'AT_FggIqEWlvf7Nuw0SM8G9M1A1zzq2yn2o'; // Wxpusher APP Token
  const forbiddenWords = [
   "æ“ä½ ",
   "æ“ä½ å¦ˆ",
   "ä½ å¦ˆ",
   "ä½ ä»–å¦ˆ",
   "å¦ˆçš„",
    "å»æ­»",
    "æ­»",
    "å‚»é€¼",
    "ç•œç”Ÿ",
    "çŒª",
    "ç‹—",
    "åƒåœ¾",
    "æœ‰ç—…",
    "ç¥ç»ç—…",
    "ä¹¡é‡Œåˆ«",
    "æ¶å¿ƒ",
    "é—­å˜´",
    "åˆ«åºŸè¯",
    "å¹¿å‘Š",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "æ¨å¹¿",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "ä¼˜æƒ ",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "å…è´¹",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "ç‚¹å‡»",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "æ³¨å†Œ",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "èµšé’±",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "ä»£ç†",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "è½¬å‘",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "ä¿¡æ¯",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "æ´»åŠ¨",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "è´­ä¹°",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "æœåŠ¡",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "å®£ä¼ ",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "è¥é”€",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "ç½‘ç«™",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "é“¾æ¥",       // å¹¿å‘Šç›¸å…³è¯æ±‡
    "æŠ˜æ‰£",       // ä¸æŠ˜æ‰£ç›¸å…³çš„è¯æ±‡
    "ç‰¹ä»·",       // ä¸æŠ˜æ‰£ç›¸å…³çš„è¯æ±‡
    "ä¼˜æƒ åˆ¸",     // ä¸æŠ˜æ‰£ç›¸å…³çš„è¯æ±‡
    "ä¿ƒé”€",       // ä¸æŠ˜æ‰£ç›¸å…³çš„è¯æ±‡
    "æ‰“æŠ˜",       // ä¸æŠ˜æ‰£ç›¸å…³çš„è¯æ±‡
    "ä¿å•",       // ä¸ä¿é™©ç›¸å…³çš„è¯æ±‡
    "ç†èµ”",       // ä¸ä¿é™©ç›¸å…³çš„è¯æ±‡
    "æŠ•ä¿",       // ä¸ä¿é™©ç›¸å…³çš„è¯æ±‡
    "ä¿é™©å…¬å¸",   // ä¸ä¿é™©ç›¸å…³çš„è¯æ±‡
    "è½¦é™©",       // ä¸ä¿é™©ç›¸å…³çš„è¯æ±‡
    "æ„å¤–é™©",     // ä¸ä¿é™©ç›¸å…³çš„è¯æ±‡
    "åŒ»ç–—é™©"      // ä¸ä¿é™©ç›¸å…³çš„è¯æ±‡
	]; // è¿ç¦è¯åˆ—è¡¨
    const maxNotificationsPerHour = 100; // æ¯å°æ—¶æœ€å¤šå‘é€é€šçŸ¥æ¬¡æ•°
    const intervalTime = 2 * 1000; // æ¯æ¬¡é€šçŸ¥é—´éš”æ—¶é—´45ç§’

        let currentUIDs = [];
        let currentPhone = '';

    // è·å–æœ¬åœ°å­˜å‚¨çš„å‘é€æ¬¡æ•°å’Œæ—¶é—´æˆ³
let notificationCount = 0; // å½“å‰å°æ—¶å†…çš„å‘é€æ¬¡æ•°
let lastNotificationTime = 0; // ä¸Šæ¬¡å‘é€é€šçŸ¥çš„æ—¶é—´æˆ³ï¼ˆå½“å‰å°æ—¶å†…çš„ï¼‰
let hourStartTime = new Date().setHours(new Date().getHours(), 0, 0, 0); // å½“å‰å°æ—¶çš„å¼€å§‹æ—¶é—´æˆ³
let timeUntilReset = 0; // å‰©ä½™æ—¶é—´ç›´åˆ°é‡ç½®ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰
 let countdownInterval;  // ç”¨æ¥å­˜å‚¨å€’è®¡æ—¶çš„å®šæ—¶å™¨

//è½¦ç‰Œæ¡†ä»£ç 
   function checkLicensePlate() {
            const licensePlate = document.getElementById('licensePlateInput').value.trim().toUpperCase();
            if (wxpusherUIDs[licensePlate]) {
                currentUIDs = wxpusherUIDs[licensePlate];
                currentPhone = phoneNumbers[licensePlate];
                document.getElementById('inputContainer').style.display = 'none';
                document.getElementById('notificationContainer').style.display = 'block';
            } else {
                document.getElementById('errorMessage').style.display = 'block';
            }
        }

// æ›´æ–°å‘é€æ¬¡æ•°æ˜¾ç¤º
function updateNotificationCountDisplay() {
    const displayElement = document.getElementById("notificationCountDisplay");
    displayElement.textContent = `å·²å‘é€å¾®ä¿¡é€šçŸ¥æ¬¡æ•°ï¼š${notificationCount}/${maxNotificationsPerHour}`;
}

// æ›´æ–°å‰©ä½™æ—¶é—´æ˜¾ç¤º
function updateTimeUntilReset() {
    const resetElement = document.getElementById("timeUntilReset");
    const currentTime = new Date().getTime();
    const nextHourStartTime = hourStartTime + 3600 * 1000;
    timeUntilReset = nextHourStartTime - currentTime;
    const minutesUntilReset = Math.floor(timeUntilReset / (1000 * 60));
    const secondsUntilReset = Math.floor((timeUntilReset % (1000 * 60)) / 1000);
    resetElement.textContent = `è·ä¸‹æ—¶æ®µå¾®ä¿¡é€šçŸ¥æ¬¡æ•°æ¢å¤å‰©ä½™: ${minutesUntilReset}åˆ†é’Ÿ${secondsUntilReset}ç§’`;
}
  //å®šä¹‰ä¸‹æ‹‰æ¡†
        function useTemplateFromSelect() {
            const template = document.getElementById("templateSelect").value;
            document.getElementById("messageInput").value = template; 
        }
    // æ›´æ–°é€šçŸ¥å­—ç¬¦æ•°
    function updateCharCount() {
        const message = document.getElementById("messageInput").value;
        const count = message.length;
        document.getElementById("charCount").textContent = `${count}/50å­—`;
    }

// ä½¿ç”¨é€‰æ‹©çš„æ¨¡æ¿å†…å®¹æ›´æ–°æ¶ˆæ¯æ¡†
function useTemplateFromSelect() {
    const template = document.getElementById("templateSelect").value;
    const messageInput = document.getElementById("messageInput");
    
    if (template) {
        messageInput.value = template;  // æ›´æ–°æ¶ˆæ¯æ¡†å†…å®¹
        updateCharCount();  // æ›´æ–°å­—ç¬¦æ•°
    }
}
    // æ£€æŸ¥é€šçŸ¥è¿ç¦è¯
    function containsForbiddenWords(message) {
        return forbiddenWords.some(word => message.includes(word));
    }

// å‘é€é€šçŸ¥çš„å‡½æ•°
function notifyOwner() {
    const messageInput = document.getElementById("messageInput");
    const message = messageInput.value.trim();  // è·å–å¹¶å»é™¤å‰åç©ºæ ¼

    // å¦‚æœæ¶ˆæ¯ä¸ºç©ºï¼Œåˆ™æç¤ºç”¨æˆ·å¡«å†™å†…å®¹
    if (!message) {
        alert("é€šçŸ¥å‘é€å¤±è´¥ï¼Œæ‚¨æ²¡æœ‰é€‰æ‹©æ¨¡æ¿æˆ–è¾“å…¥ä»»ä½•é€šçŸ¥å†…å®¹ã€‚");
        return;
    }
      // æ£€æŸ¥ç½‘ç»œè¿æ¥
    if (!navigator.onLine) {
        alert("é€šçŸ¥å‘é€å‡ºé”™ï¼Œè¯·æ£€æŸ¥æ‚¨çš„ç½‘ç»œè¿æ¥ã€‚");
        return;
    }
        // è¿ç¦è¯æ£€æŸ¥
        if (containsForbiddenWords(message)) {
            alert("é€šçŸ¥å†…å®¹åŒ…å«è¿ç¦è¯ï¼Œæ— æ³•å‘é€");
            return;
        }
 // é€šçŸ¥å‘é€é¢‘ç‡é™åˆ¶ï¼ˆæ¯å°æ—¶ï¼‰
    const currentTime = new Date().getTime();
    if (currentTime < hourStartTime + 3600 * 1000) { // ç¡®ä¿åœ¨å½“å‰å°æ—¶å†…
        if (currentTime - lastNotificationTime < intervalTime) {
            const remainingTime = Math.ceil((intervalTime - (currentTime - lastNotificationTime)) / 1000);
            alert(`è¯·ç­‰å¾… ${remainingTime} ç§’åå†å‘é€é€šçŸ¥ã€‚`);
            return;
        }
        // æ›´æ–°å‘é€æ¬¡æ•°å’Œæ—¶é—´æˆ³
        notificationCount++;
        lastNotificationTime = currentTime;
        if (notificationCount > maxNotificationsPerHour) {
            notificationCount = maxNotificationsPerHour; // é˜²æ­¢è¶…è¿‡æœ€å¤§æ¬¡æ•°
        }
        localStorage.setItem('notificationCount', notificationCount);
        localStorage.setItem('lastNotificationTime', lastNotificationTime);
        localStorage.setItem('hourStartTime', hourStartTime); // å­˜å‚¨å½“å‰å°æ—¶çš„å¼€å§‹æ—¶é—´ï¼Œç”¨äºé‡ç½®
    } else {
        // æ–°çš„ä¸€å°æ—¶å¼€å§‹ï¼Œé‡ç½®å‘é€æ¬¡æ•°å’Œæ—¶é—´æˆ³
        notificationCount = 1;
        lastNotificationTime = currentTime;
        hourStartTime = currentTime - (currentTime % 3600 * 1000) + 3600 * 1000 - intervalTime; // ç¡®ä¿ä¸‹ä¸€æ¬¡å‘é€ä¸ä¼šç«‹å³è§¦å‘ï¼ˆå‡å»é—´éš”æ—¶é—´ï¼‰
        localStorage.setItem('notificationCount', notificationCount);
        localStorage.setItem('lastNotificationTime', lastNotificationTime);
        localStorage.setItem('hourStartTime', hourStartTime);
    }
    // æ›´æ–°å‘é€æ¬¡æ•°æ˜¾ç¤º
    updateNotificationCountDisplay();
    // é¡µé¢åŠ è½½å®Œæˆåæˆ–å‘é€é€šçŸ¥åæ›´æ–°å‰©ä½™æ—¶é—´
    updateTimeUntilReset();
  
    // ç¦ç”¨é€šçŸ¥æŒ‰é’®å¹¶å¼€å§‹å€’è®¡æ—¶
    const notifyBtn = document.getElementById("notifyBtn");
    notifyBtn.classList.add("disabled");  // Add disabled class for opacity mask
    let countdownTime = 30;
    notifyBtn.textContent = `è¯·ç­‰å¾… ${countdownTime} ç§’åå†å‘é€é€šçŸ¥`;

    countdownInterval = setInterval(() => {
        countdownTime--;
        notifyBtn.textContent = `è¯·ç­‰å¾… ${countdownTime} ç§’åå†å‘é€é€šçŸ¥`;
        if (countdownTime <= 0) {
            clearInterval(countdownInterval);
            notifyBtn.classList.remove("disabled");  // Remove the disabled class after countdown ends
            notifyBtn.textContent = "å¾®ä¿¡ä¸€é”®é€šçŸ¥è½¦ä¸»ğŸ“±";
        }
    }, 1000);
  
        //  å¦‚æœç½‘ç»œå¯ç”¨ï¼Œç»§ç»­å‘é€é€šçŸ¥é€»è¾‘
        fetch("https://wxpusher.zjiecode.com/api/send/message", {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                appToken: wxpusherAppToken,
                content: message,
                uids: currentUIDs
            })
        }) .then(response => response.json())
    .then(data => {
      if (data.code === 1000) {
        alert("é€šçŸ¥å·²é€è¾¾ï¼Œè¯·è€å¿ƒç­‰å¾…è½¦ä¸»ã€‚");
      // ç¼–è¾‘æ¡†é‡ç½®ä¸ºç©ºç™½
        document.getElementById("messageInput").value = '';   
        updateCharCount();
  document.getElementById("templateSelect").value = '';
      } 
    });
       // æ£€æŸ¥æ˜¯å¦è¾¾åˆ°æ˜¾ç¤ºç”µè¯å·ç çš„æ¡ä»¶
        if (notificationCount >= maxNotificationsPerHour) {
       alert("ä»Šæ—¥è¯¥å°æ—¶é€šçŸ¥æ¬¡æ•°å·²ç”¨å®Œï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä¸€é”®æ‹¨æ‰“è½¦ä¸»ç”µè¯ã€‚");
           document.getElementById("notifyBtn").style.display = "none"; // è¾¾åˆ°æŒ‡å®šæ¬¡æ•°åéšè—å‘é€ä¿¡æ¯æŒ‰é’®
            document.getElementById("callBtn").style.display = "block"; // å‘é€é€šçŸ¥åæ˜¾ç¤ºæ‹¨æ‰“ç”µè¯æŒ‰é’®
        }
    }

    // æ˜¾ç¤ºç”µè¯æ¨¡æ€æ¡†
    function showCallModal() {
        document.getElementById("callModal").style.display = "block";
        document.getElementById("phoneNumber").textContent = 'å·ç æ˜¾ç¤ºå·²åŠ å¯†'; // åœ¨æ¨¡æ€æ¡†ä¸­æ˜¾ç¤ºç”µè¯å·ç 
    }

    // æ‹¨æ‰“ç”µè¯
    function callOwner() {
        window.location.href = `tel:${currentPhone}`;
    }

    // å…³é—­æ¨¡æ€æ¡†
    function closeModal() {
        document.getElementById("callModal").style.display = "none";
    }
/*
// å¯¹æµè§ˆå™¨çš„UserAgentè¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œä¸å«æœ‰å¾®ä¿¡ç‹¬æœ‰æ ‡è¯†çš„åˆ™ä¸ºå…¶ä»–æµè§ˆå™¨
    var useragent = navigator.userAgent;
    if (useragent.match(/MicroMessenger/i) != 'MicroMessenger') {
        // è¿™é‡Œè­¦å‘Šæ¡†ä¼šé˜»å¡å½“å‰é¡µé¢ç»§ç»­åŠ è½½
        alert('å·²ç¦æ­¢æœ¬æ¬¡è®¿é—®ï¼šæ‚¨å¿…é¡»ä½¿ç”¨å¾®ä¿¡æ‰«æäºŒç»´ç è®¿é—®æœ¬é¡µé¢ï¼');
        // ä»¥ä¸‹ä»£ç æ˜¯ç”¨javascriptå¼ºè¡Œå…³é—­å½“å‰é¡µé¢
        var opened = window.open('about:blank', '_self');
        opened.opener = null;
        opened.close();
    }

//éšè—å¼¹çª—ç½‘å€(function(){
window.alert = function(name){
var iframe = document.createElement("IFRAME");
iframe.style.display="none";
iframe.setAttribute("src", 'data:text/plain');
document.documentElement.appendChild(iframe);
window.frames[0].window.alert(name);
iframe.parentNode.removeChild(iframe);
}
*/
// é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
window.addEventListener("load", function() {
    // ä»localStorageè·å–æ•°æ®ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
    const storedNotificationCount = parseInt(localStorage.getItem('notificationCount')) || 0;
    const storedLastNotificationTime = parseInt(localStorage.getItem('lastNotificationTime')) || 0;
    const storedHourStartTime = parseInt(localStorage.getItem('hourStartTime')) || new Date().setHours(new Date().getHours(), 0, 0, 0);

    // åˆå§‹åŒ–å˜é‡
    notificationCount = (new Date().getTime() < storedHourStartTime + 3600 * 1000) ? storedNotificationCount : 0; // åˆ¤æ–­æ˜¯å¦åœ¨åŒä¸€å°æ—¶å†…
    lastNotificationTime = storedLastNotificationTime;
   hourStartTime = new Date().setHours(new Date().getHours(), 0, 0, 0); // å½“å‰å°æ—¶çš„å¼€å§‹æ—¶é—´æˆ³

    // æ›´æ–°å‘é€æ¬¡æ•°æ˜¾ç¤ºå’Œå‰©ä½™æ—¶é—´æ˜¾ç¤º
    updateNotificationCountDisplay();
    updateTimeUntilReset();

        // æ£€æŸ¥æ˜¯å¦è¾¾åˆ°æ˜¾ç¤ºç”µè¯å·ç çš„æ¡ä»¶
        if (notificationCount >= maxNotificationsPerHour) {
           document.getElementById("notifyBtn").style.display = "none"; // è¾¾åˆ°æŒ‡å®šæ¬¡æ•°åéšè—å‘é€ä¿¡æ¯æŒ‰é’®
            document.getElementById("callBtn").style.display = "block"; // å‘é€é€šçŸ¥åæ˜¾ç¤ºæ‹¨æ‰“ç”µè¯æŒ‰é’®
       alert("ä»Šæ—¥è¯¥å°æ—¶é€šçŸ¥æ¬¡æ•°å·²ç”¨å®Œï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä¸€é”®æ‹¨æ‰“è½¦ä¸»ç”µè¯ã€‚");
        }
    // è®¾ç½®ä¸€ä¸ªå®šæ—¶å™¨æ¯ç§’æ›´æ–°å‰©ä½™æ—¶é—´ï¼ˆå¯é€‰ï¼Œä½†æ¨èä»¥å®ç°å®æ—¶æ›´æ–°ï¼‰
    setInterval(updateTimeUntilReset, 1000);
    });
</script>
</body>
</html>
